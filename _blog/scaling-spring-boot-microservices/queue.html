{% include_relative queue.svg %}
<script>
(function() {
  const svg = document.querySelector('#queue')
  const wrapper = document.createElement('div')
  wrapper.classList = 'relative'
  const restart = document.createElement('div')
  restart.classList = 'restart'
  restart.innerHTML = '<span>Restart</span>'
  wrap(svg, wrapper)
  wrapper.appendChild(restart)
  const basicTimeline = anime.timeline({
    autoplay: false,
  });
  setup()
  basicTimeline
  .add({
    begin: function() {
      wrapper.onclick = function() {}
      restart.classList.add('inactive');
      setup()
    }
  })
  .add({
    targets: '#queue-animejs-message1',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-message2',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-message3',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-message4',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-arrow1',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [32, 25],
    easing: 'easeInExpo',
    complete: function() {
      var layer = document.querySelector('#queue-animejs-layer3');
      if (!!layer) layer.style.opacity = 1;
    }
  })
  .add({
    targets: '#queue-animejs-message1',
    opacity: [1, 0],
    easing: 'easeOutExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [25, 17],
    easing: 'easeInExpo',
    complete: function() {
      var layer = document.querySelector('#queue-animejs-layer4');
      if (!!layer) layer.style.opacity = 1;
    }
  })
  .add({
    targets: '#queue-animejs-message2',
    opacity: [1, 0],
    easing: 'easeOutExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [17, 8],
    easing: 'easeInExpo',
    complete: function() {
      var layer = document.querySelector('#queue-animejs-layer5');
      if (!!layer) layer.style.opacity = 1;
    }
  })
  .add({
    targets: '#queue-animejs-message3',
    opacity: [1, 0],
    easing: 'easeOutExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [8, 0],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-message4',
    opacity: [1, 0],
    easing: 'easeOutExpo',
  })
  .add({
    targets: '#queue-animejs-arrow1',
    opacity: [1, 0],
    easing: 'easeOutExpo',
  })
  .add({
    targets: '#queue-animejs-arrow2',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [0, 8],
    easing: 'easeInExpo',
    complete: function() {
      var layer = document.querySelector('#queue-animejs-layer5');
      if (!!layer) layer.style.opacity = 0;
    }
  })
  .add({
    targets: '#queue-animejs-message5',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [8, 17],
    easing: 'easeInExpo',
    complete: function() {
      var layer = document.querySelector('#queue-animejs-layer4');
      if (!!layer) layer.style.opacity = 0;
    }
  })
  .add({
    targets: '#queue-animejs-message6',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [17, 25],
    easing: 'easeInExpo',
    complete: function() {
      var layer = document.querySelector('#queue-animejs-layer3');
      if (!!layer) layer.style.opacity = 0;
    }
  })
  .add({
    targets: '#queue-animejs-message7',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-top',
    translateY: [25, 32],
    easing: 'easeInExpo',
    complete: function() {
      var layer = document.querySelector('#queue-animejs-layer2');
      if (!!layer) layer.style.opacity = 0;
    }
  })
  .add({
    targets: '#queue-animejs-message8',
    opacity: [0, 1],
    easing: 'easeInExpo',
  })
  .add({
    targets: '#queue-animejs-arrow2',
    opacity: [1, 0],
    easing: 'easeOutExpo',
  })
  .add({
    complete: function() {
      wrapper.onclick = basicTimeline.restart
      restart.classList.remove('inactive')
    }
  })
  wrapper.onclick = basicTimeline.restart
  onScrollIntoView(svg, function() {
    setTimeout(basicTimeline.play, 1000)
  });
  function wrap(el, wrapper) {
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }
  function setup() {
    [
      '#queue-animejs-layer3',
      '#queue-animejs-layer4',
      '#queue-animejs-layer5'
    ].forEach(function(selector) {
      var layer = document.querySelector(selector);
      if (!!layer) layer.style.opacity = 0;
    })
    var layer2 = document.querySelector('#queue-animejs-layer2');
    if (!!layer2) layer2.style.opacity = 1;
  }
})();
</script>